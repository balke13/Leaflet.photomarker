L.PhotoIcon=L.Class.extend({options:{className:"leaflet-photolayer-img"},initialize:function(i){L.setOptions(this,i),this.original_size=L.point(i.size),this.size=this.original_size},scale:function(i){var e=this.original_size.multiplyBy(i);e.x!==this.size.x&&e.y!==this.size.y&&this.resize(e)},createIcon:function(){if(!this.img){var i=this.options.src;if(!i){if("icon"===name)throw Error("iconUrl not set in Icon options (see the docs).");return null}this.img=this._createImg(i)}return L.DomUtil.addClass(this.img,"leaflet-marker-icon"),L.DomUtil.addClass(this.img,this.options.className),this._setIconSize(this.img,this.size),this.img},resize:function(i){this.size=i,this._setIconSize(this.img,this.size)},createShadow:function(){return null},_setIconSize:function(i,e){var t=e.divideBy(2,!0);t&&(i.style.marginLeft=-t.x+"px",i.style.marginTop=-t.y+"px"),e&&(i.style.width=e.x+"px",i.style.height=e.y+"px")},_createImg:function(i){var e;return L.Browser.ie6?(e=document.createElement("div"),e.style.filter='progid:DXImageTransform.Microsoft.AlphaImageLoader(src="'+i+'")'):(e=document.createElement("img"),e.src=i),e}}),L.PhotoMarker=L.Marker.extend({options:{title:"",clickable:!0,draggable:!1,zIndexOffset:0,opacity:1,riseOnHover:!0,riseOffset:250},initialize:function(i,e){e.icon=new L.PhotoIcon({src:e.src,size:e.size}),"function"==typeof e.resize&&this.on("resize",e.resize),L.Marker.prototype.initialize.call(this,i,e)},_initIcon:function(){L.Marker.prototype._initIcon.call(this),this.resize()},onAdd:function(i){i.on("zoomend",this.resize,this),L.Marker.prototype.onAdd.call(this,i)},onRemove:function(i){i.off("zoomend",this.resize,this),L.Marker.prototype.onRemove.call(this,i)},scale:function(i){var e=this.options.icon;e.scale(i)},resize:function(){this.fire("resize",{map:this._map,zoom:this._map.getZoom()})}}),L.photoMarker=function(i,e){return new L.PhotoMarker(i,e)};